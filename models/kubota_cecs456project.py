# -*- coding: utf-8 -*-
"""Kubota_CECS456Project.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1cfvcM1OdEkkEs8-JrjmwafFz_PVHTIxS

# Setup
"""

# Install necessary packages
!pip install opendatasets

import tensorflow as tf
from tensorflow import keras
import sklearn
import numpy as np
import matplotlib as mpl
import matplotlib.pyplot as plt

# For reading the dataset from Kaggle
import opendatasets as od
import pandas

# For reading the image file paths from the "Files" tab
import os

# For reading the actual images from "Files" tab
from PIL import Image
import PIL

# For specifying variable types
from typing import Tuple

# Set the random seed
np.random.seed(42)

# Define some variables
labels = ("airplane", "car", "cat", "dog", "flower", "fruit", "motorbike", "person")

# Load the dataset from Kaggle


# Download Kaggle API token key from the Kaggle website while logged into your account
# Use this key to login when running this code block
dataset_path = "https://www.kaggle.com/datasets/prasunroy/natural-images"
od.download(dataset_path)

# Returns the images and labels of all examples in the dataset
def load_dataset(dataset_directory: str) -> Tuple[PIL.JpegImagePlugin.JpegImageFile, str]:
  x_all, y_all = [], []
  # Traverse through the directory
  for root, directories, files in os.walk(dataset_directory):
    for filename in files:
      # Join the strings to get the file's full path
      filepath = os.path.join(root, filename)
      for label in labels:
        # An example is labeled if its file path contains the label in its name
        if label in filename:
          y_all.append(label)
          x_all.append(Image.open(filepath))
  return x_all, y_all


natural_dataset_path = "natural-images/data/natural_images"
x_all, y_all = load_dataset(natural_dataset_path)

print("X size = ", len(x_all))
print("Y size = ", len(y_all))

testIndex = 1111
plt.imshow(x_all[testIndex])
y_all[testIndex]
type(x_all[testIndex])